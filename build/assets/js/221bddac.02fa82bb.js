"use strict";(self.webpackChunknym_docs=self.webpackChunknym_docs||[]).push([[5563],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return h}});var o=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=o.createContext({}),d=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=d(e.components);return o.createElement(l.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(t),h=i,c=u["".concat(l,".").concat(h)]||u[h]||m[h]||a;return t?o.createElement(c,r(r({ref:n},p),{},{components:t})):o.createElement(c,r({ref:n},p))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,r=new Array(a);r[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var d=2;d<a;d++)r[d]=t[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},7972:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return p},default:function(){return u}});var o=t(7462),i=t(3366),a=(t(7294),t(3905)),r=["components"],s={sidebar_label:"Mixnode Troubleshooting FAQ",description:"This page will help you find answers to common issues with setting up and maintaining mixnodes",hide_title:!1,title:"Mixnode Troubleshooting FAQ"},l=void 0,d={unversionedId:"run-nym-nodes/troubleshooting",id:"version-0.11.0/run-nym-nodes/troubleshooting",isDocsHomePage:!1,title:"Mixnode Troubleshooting FAQ",description:"This page will help you find answers to common issues with setting up and maintaining mixnodes",source:"@site/versioned_docs/version-0.11.0/run-nym-nodes/troubleshooting.md",sourceDirName:"run-nym-nodes",slug:"/run-nym-nodes/troubleshooting",permalink:"/docs/0.11.0/run-nym-nodes/troubleshooting",version:"0.11.0",lastUpdatedAt:1629392815,formattedLastUpdatedAt:"8/19/2021",frontMatter:{sidebar_label:"Mixnode Troubleshooting FAQ",description:"This page will help you find answers to common issues with setting up and maintaining mixnodes",hide_title:!1,title:"Mixnode Troubleshooting FAQ"},sidebar:"version-0.11.0/sidebar",previous:{title:"Gateways",permalink:"/docs/0.11.0/run-nym-nodes/gateways"},next:{title:"Use Apps",permalink:"/docs/0.11.0/use-apps/index"}},p=[{value:"How can I tell my node is up and running and mixing traffic?",id:"how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic",children:[]},{value:"Why is my node not mixing any packets?",id:"why-is-my-node-not-mixing-any-packets",children:[]},{value:"Common errors and warnings",id:"common-errors-and-warnings",children:[]},{value:"Can I use a port other than 1789 ?",id:"can-i-use-a-port-other-than-1789-",children:[]},{value:"Where can I find my private and public keys and mixnode config?",id:"where-can-i-find-my-private-and-public-keys-and-mixnode-config",children:[]},{value:"What is <code>verloc</code> and do I have to configure my mixnode to implement it?",id:"what-is-verloc-and-do-i-have-to-configure-my-mixnode-to-implement-it",children:[]},{value:"Where can I get more help?",id:"where-can-i-get-more-help",children:[]}],m={toc:p};function u(e){var n=e.components,t=(0,i.Z)(e,r);return(0,a.kt)("wrapper",(0,o.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h3",{id:"how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic"},"How can I tell my node is up and running and mixing traffic?"),(0,a.kt)("p",null,"First of all check the 'Mixnodes' section of the testnet ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-explorer.nymtech.net/"},"dashboard")," and enter your ",(0,a.kt)("strong",{parentName:"p"},"identity key"),", and you should see your node. Alternatively you can check the ",(0,a.kt)("a",{parentName:"p",href:"https://nodes.guru/nym/leaderboard"},"leaderboard interface")," created by community member Evgeny Garanin from ",(0,a.kt)("a",{parentName:"p",href:"https://nodes.guru"},"Nodes Guru"),"."),(0,a.kt)("p",null,"If you want more information, or if your node isn't showing up and you want to double-check, here are some examples on how to check if the node is configured properly."),(0,a.kt)("h4",{id:"check-from-your-vps"},"Check from your VPS"),(0,a.kt)("p",null,"Additional details can be obtained via various methods after you connect to your VPS:"),(0,a.kt)("h5",{id:"socket-statistics-with-ss"},"Socket statistics with ",(0,a.kt)("inlineCode",{parentName:"h5"},"ss")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo ss -s -t | grep 1789 # if you have specified a different port in your mixnode config, change accordingly\n")),(0,a.kt)("p",null,"This command should return a lot of data containing ",(0,a.kt)("inlineCode",{parentName:"p"},"ESTAB"),". This command should work on every unix based system."),(0,a.kt)("h5",{id:"list-open-files-and-reliant-processes-with-lsof"},"List open files and reliant processes with ",(0,a.kt)("inlineCode",{parentName:"h5"},"lsof")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# check if lsof is installed:\nlsof -v\n# install if not installed\nsudo apt install lsof\n# run against mixnode port\nsudo lsof -i TCP:1789 # if you have specified a different port in your mixnode config, change accordingly\n")),(0,a.kt)("p",null,"This command should return something like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"nym-mixno 103349 root   53u  IPv6 1333229972      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:57844->[2a01:4f9:c011:38ae::5]:1789 (ESTABLISHED)\nnym-mixno 103349 root   54u  IPv4 1333229973      0t0  TCP nym:57104->194.5.78.73:1789 (ESTABLISHED)\nnym-mixno 103349 root   55u  IPv4 1333229974      0t0  TCP nym:48130->static.236.109.119.168.clients.your-server.de:1789 (ESTABLISHED)\nnym-mixno 103349 root   56u  IPv4 1333229975      0t0  TCP nym:52548->vmi572614.contaboserver.net:1789 (ESTABLISHED)\nnym-mixno 103349 root   57u  IPv6 1333229976      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:43244->[2600:1f18:1031:2401:c04b:2f25:ca79:fef3]:1789 (ESTABLISHED)\n")),(0,a.kt)("h5",{id:"query-systemd-journal-with-journalctl"},"Query ",(0,a.kt)("inlineCode",{parentName:"h5"},"systemd")," journal with ",(0,a.kt)("inlineCode",{parentName:"h5"},"journalctl")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'sudo journalctl -u nym-mixnode -o cat | grep "Since startup mixed"\n')),(0,a.kt)("p",null,"If you have created ",(0,a.kt)("inlineCode",{parentName:"p"},"nym-mixnode.service")," file (i.e. you are running your mixnode via ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd"),") then this command shows you how many packets have you mixed so far, and should return a list of messages like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"2021-05-18T12:35:24.057Z INFO  nym_mixnode::node::metrics                      > Since startup mixed 233639 packets!\n2021-05-18T12:38:02.178Z INFO  nym_mixnode::node::metrics                      > Since startup mixed 233739 packets!\n2021-05-18T12:40:32.344Z INFO  nym_mixnode::node::metrics                      > Since startup mixed 233837 packets!\n2021-05-18T12:46:08.549Z INFO  nym_mixnode::node::metrics                      > Since startup mixed 234081 packets!\n2021-05-18T12:56:57.129Z INFO  nym_mixnode::node::metrics                      > Since startup mixed 234491 packets!\n")),(0,a.kt)("p",null,"You can add ",(0,a.kt)("inlineCode",{parentName:"p"}," | tail")," to the end of the command to watch for new entries in real time if needed."),(0,a.kt)("h4",{id:"check-from-your-local-machine"},"Check from your local machine"),(0,a.kt)("h5",{id:"scan-ports-with-nmap"},"Scan ports with ",(0,a.kt)("inlineCode",{parentName:"h5"},"nmap"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"nmap -p 1789 <IP ADDRESS> -Pn\n")),(0,a.kt)("p",null,"If your mixnode is configured properly it should output something like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"bob@desktop:~$ nmap -p 1789 95.296.134.220 -Pn\n\nHost is up (0.053s latency).\n\nPORT     STATE SERVICE\n1789/tcp open  hello\n")),(0,a.kt)("h5",{id:"query-all-nodes-and-parse-with-jq"},"Query all nodes and parse with ",(0,a.kt)("inlineCode",{parentName:"h5"},"jq"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"curl https://testnet-milhon-explorer.nymtech.net/data/mixnodes.json | jq\n")),(0,a.kt)("p",null,"Should return a JSON object of all nodes currently online."),(0,a.kt)("p",null,"This command can be further parsed by various keys, such as location:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"curl https://testnet-milhon-explorer.nymtech.net/data/mixnodes.json | jq -r '.[].mix_node | select(.location == \"London\")'\n")),(0,a.kt)("p",null,"or address:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"curl https://testnet-milhon-explorer.nymtech.net/data/mixnodes.json | jq -r '.[].mix_node | select(.host | startswith(\"65.21\")) | .host'\n")),(0,a.kt)("h4",{id:"check-with-testnet-api"},"Check with testnet API"),(0,a.kt)("p",null,"We currently have an API set up returning our metrics tests of the network. There are two endpoints to ping for information about your mixnode, ",(0,a.kt)("inlineCode",{parentName:"p"},"report")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"history"),". Find more information about this in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/0.11.0/run-nym-nodes/mixnodes"},"Mixnodes metrics documentation"),"."),(0,a.kt)("h3",{id:"why-is-my-node-not-mixing-any-packets"},"Why is my node not mixing any packets?"),(0,a.kt)("p",null,"If you are still unable to see your node on the ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-explorer.nymtech.net/"},"dashboard"),", or your node is declaring it has not mixed any packets, there are several potential issues:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The firewall on your host machine is not configured properly."),(0,a.kt)("li",{parentName:"ul"},"You provided incorrect information when bonding your node via the ",(0,a.kt)("a",{parentName:"li",href:"https://testnet-milhon-wallet.nymtech.net/"},"web wallet")),(0,a.kt)("li",{parentName:"ul"},"You are running your mixnode from a VPS without IPv6 support."),(0,a.kt)("li",{parentName:"ul"},"You did not use the ",(0,a.kt)("inlineCode",{parentName:"li"},"--announce-host")," flag while running the mixnode from your local machine behind NAT."),(0,a.kt)("li",{parentName:"ul"},"You did not configure your router firewall while running the mixnode from your local machine behind NAT, or you are lacking IPv6 support."),(0,a.kt)("li",{parentName:"ul"},"Your mixnode is not running at all, it has either exited / panicked or you closed the session without making the node persistent.")),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Your mixnode ",(0,a.kt)("strong",{parentName:"p"},"must speak both IPv4 and IPv6")," in order to cooperate with other nodes and route traffic. This is a common reason behind many errors we are seeing among node operators, so check with your provider that your VPS is able to do this!"))),(0,a.kt)("h4",{id:"incorrectly-configured-firewall"},"Incorrectly configured firewall"),(0,a.kt)("p",null,"The most common reason your mixnode might not be mixing packets is due to a poorly configured firewall. The following commands will allow you to set up a firewall using ",(0,a.kt)("inlineCode",{parentName:"p"},"ufw"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# check if you have ufw installed\nufw version\n# if it is not installed, install with\nsudo apt install ufw -y\n# enable ufw\nsudo ufw enable\n# check the status of the firewall\nsudo ufw status\n")),(0,a.kt)("p",null,"Finally open your mixnode's p2p port, as well as ports for ssh, http, and https connections, and ports ",(0,a.kt)("inlineCode",{parentName:"p"},"8000")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"1790")," for verloc and measurement pings:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo ufw allow 1789,1790,8000,22,80,443/tcp\n# check the status of the firewall\nsudo ufw status\n")),(0,a.kt)("h4",{id:"incorrect-bonding-information"},"Incorrect bonding information"),(0,a.kt)("p",null,"Check that you have provided the correct information when bonding your mixnode in the web wallet ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-wallet.nymtech.net/"},"interface"),". When in doubt, unbond and then rebond your node!"),(0,a.kt)("h4",{id:"missing-announce-host-flag"},"Missing ",(0,a.kt)("inlineCode",{parentName:"h4"},"announce-host")," flag"),(0,a.kt)("p",null,"On certain cloud providers such as AWS and Google Cloud, you need to do some additional configuration of your firewall and use ",(0,a.kt)("inlineCode",{parentName:"p"},"--host")," with your ",(0,a.kt)("strong",{parentName:"p"},"local ip")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"--announce-host")," with the ",(0,a.kt)("strong",{parentName:"p"},"public ip")," of your mixnode host."),(0,a.kt)("h4",{id:"no-ipv6-connectivity"},"No IPv6 connectivity"),(0,a.kt)("p",null,"Make sure that your VPS has IPv6 connectivity available with whatever provider you are using."),(0,a.kt)("p",null,"To get all ip addresses of your host, try following commands:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"hostname -i\n")),(0,a.kt)("p",null,"Will return your ",(0,a.kt)("strong",{parentName:"p"},"local ip")," address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"hostname -I\n")),(0,a.kt)("p",null,"Will return all of the ip addresses of your host. This output should look something like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"bob@nym:~$ hostname -I\n88.36.11.23 172.18.0.1 2a01:28:ca:102::1:641\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The first ",(0,a.kt)("strong",{parentName:"li"},"ipv4")," is the public ip you need to use for the ",(0,a.kt)("inlineCode",{parentName:"li"},"--announce-host")," flag."),(0,a.kt)("li",{parentName:"ul"},"The second ",(0,a.kt)("strong",{parentName:"li"},"ipv4")," is the local ip you need to use for the ",(0,a.kt)("inlineCode",{parentName:"li"},"--host")," flag."),(0,a.kt)("li",{parentName:"ul"},"The 3rd output should confirm if your machine has ipv6 available.")),(0,a.kt)("h4",{id:"running-on-a-local-machine-behind-nat-with-no-fixed-ip-address"},"Running on a local machine behind NAT with no fixed IP address"),(0,a.kt)("p",null,"Your ISP has to be IPv6 ready if you want to run a mixnode on your local machine. Sadly, in 2020, most of them are not and you won't get an IPv6 address by default from your ISP. Usually it is a extra paid service or they simply don't offer it."),(0,a.kt)("p",null,"Before you begin, check if you have IPv6 ",(0,a.kt)("a",{parentName:"p",href:"https://test-ipv6.cz/"},"here"),". If not, then don't waste your time to run a node which won't ever be able to mix any packet due to this limitation. Call your ISP and ask for IPv6, there is a plenty of it for everyone!"),(0,a.kt)("p",null,"If all goes well and you have IPv6 available, then you will need to ",(0,a.kt)("inlineCode",{parentName:"p"},"init")," the mixnode with an extra flag, ",(0,a.kt)("inlineCode",{parentName:"p"},"--announce-host"),". You will also need to edit your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.toml")," file each time your IPv4 address changes, that could be a few days or a few weeks."),(0,a.kt)("p",null,"Additional configuration on your router might also be needed to allow traffic in and out to port 1789 and IPv6 support."),(0,a.kt)("p",null,"Here is a sample of the ",(0,a.kt)("inlineCode",{parentName:"p"},"init")," command to create the mixnode config."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"./target/release/nym-mixnode init --id nym-nat --host 0.0.0.0 --announce-host 85.160.12.13 --layer 3\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"--host 0.0.0.0")," should work everytime even if your local machine IPv4 address changes. For example on Monday your router gives your machine an address ",(0,a.kt)("inlineCode",{parentName:"p"},"192.168.0.13")," and on Wednesday, the DHCP lease will end and you will be asigned ",(0,a.kt)("inlineCode",{parentName:"p"},"192.168.0.14"),". Using ",(0,a.kt)("inlineCode",{parentName:"p"},"0.0.0.0")," should avoid this without having to set any static ip in your router`s configuration.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"you can get your current IPv4 address by either using ",(0,a.kt)("inlineCode",{parentName:"p"},"curl ipinfo.io")," if you're on MacOS or Linux or visiting ",(0,a.kt)("a",{parentName:"p",href:"https://www.whatsmyip.org/"},"whatsmyip site"),". Simply copy it and use it as ",(0,a.kt)("inlineCode",{parentName:"p"},"--anounce-host")," address."))),(0,a.kt)("p",null,"Make sure you check if your node is really mixing. You will need a bit of luck to set this up from your home behind NAT."),(0,a.kt)("h4",{id:"accidentally-killing-your-node-process-on-exiting-session"},"Accidentally killing your node process on exiting session"),(0,a.kt)("p",null,"When you close your current terminal session, you need to make sure you don't kill the mixnode process! There are multiple ways on how to make it persistent even after exiting your ssh session, the easiest solution is to use ",(0,a.kt)("inlineCode",{parentName:"p"},"nohup"),", and the more elegant solution is to run the node with ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd"),"."),(0,a.kt)("h5",{id:"running-your-mixnode-as-a-background-process-with-nohup"},"Running your mixnode as a background process with ",(0,a.kt)("inlineCode",{parentName:"h5"},"nohup")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"nohup")," is a command with which your terminal is told to ignore the ",(0,a.kt)("inlineCode",{parentName:"p"},"HUP")," or 'hangup' signal. This will stop the mixnode process ending if you kill your session."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"nohup ./nym-mixnode run --id NYM # where `--id NYM` is the id you set during the `init` command.\n")),(0,a.kt)("h5",{id:"running-your-mixnode-as-a-background-process-with-systemd"},"Running your mixnode as a background process with ",(0,a.kt)("inlineCode",{parentName:"h5"},"systemd")),(0,a.kt)("p",null,"The most reliable and elegant solution is to create a ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd.service")," file and run the nym-mixnode with ",(0,a.kt)("inlineCode",{parentName:"p"},"systemctl")," command."),(0,a.kt)("p",null,"Create a file with ",(0,a.kt)("inlineCode",{parentName:"p"},"nano")," at ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/systemd/system/nym-mixnode.service")," containing the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[Unit]\nDescription=nym mixnode service\nAfter=network.target\n\n[Service]\nType=simple\nUser=nym                                      # change as appropriate\nLimitNOFILE=65536\nExecStart=/home/nym/nym-mixnode run --id nym  # change as appropriate\nKillSignal=SIGINT\nRestart=on-failure\nRestartSec=30\nRestart=on-abort\n[Install]\nWantedBy=multi-user.target\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# enable the service\nsudo systemctl enable nym-mixnode\n# start the service\nsudo systemctl start nym-mixnode\n# check if the service is running properly and mixnode is mixing\nsudo systemctl status nym-mixnode\n")),(0,a.kt)("p",null,"Now your node should be mixing all the time, and restart if you reboot your server!"),(0,a.kt)("p",null,"Anytime you change your ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd")," service file you need to ",(0,a.kt)("inlineCode",{parentName:"p"},"sudo systemctl daemon-reload")," in order to restart the service."),(0,a.kt)("h4",{id:"network-configuration-seems-fine-but-log-still-claims-since-startup-mixed-0-packets"},"Network configuration seems fine but log still claims ",(0,a.kt)("inlineCode",{parentName:"h4"},"Since startup mixed 0 packets!")),(0,a.kt)("p",null,"This behavior is most likely caused by a mismatch between your node configuration and the bonding information. Unbond and then rebond your node via the ","[web wallet]",")(",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-wallet.nymtech.net/"},"https://testnet-milhon-wallet.nymtech.net/"),"). The re-bonding procedure does not cost any additional HAL, so you can do it as often as you like."),(0,a.kt)("p",null,"Also make sure to enter all the information in the web wallet exactly as it appears in the log when you start the mixnode process. In particular, the ",(0,a.kt)("inlineCode",{parentName:"p"},"host")," field must contain the ",(0,a.kt)("em",{parentName:"p"},"port")," on which your mixnode will listen:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"correct host: ",(0,a.kt)("inlineCode",{parentName:"li"},"34.12.3.43:1789")),(0,a.kt)("li",{parentName:"ul"},"incorrect host:",(0,a.kt)("inlineCode",{parentName:"li"},"34.12.3.43"))),(0,a.kt)("h3",{id:"common-errors-and-warnings"},"Common errors and warnings"),(0,a.kt)("p",null,"Most of the ",(0,a.kt)("inlineCode",{parentName:"p"},"ERROR")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"WARN")," messages in your node logs are benign - as long as your node outputs ",(0,a.kt)("inlineCode",{parentName:"p"},"since startup mixed X packets!")," in your logs (and this number increases over time), your node is mixing packets. If you want to be sure, check the Nym ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-explorer.nymtech.net/"},"dashboard")," or see other ways on how to check if your node is mixing properly as outlined in the section ",(0,a.kt)("strong",{parentName:"p"},"How can I tell my node is up and running and mixing traffic?")," above."),(0,a.kt)("p",null,"More specific errors and warnings are covered below."),(0,a.kt)("h4",{id:"tokio-runtime-worker-error"},(0,a.kt)("inlineCode",{parentName:"h4"},"tokio runtime worker")," error"),(0,a.kt)("p",null,"If you are running into issues with an error including the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"thread 'tokio-runtime-worker' panicked at 'Failed to create TCP listener: Os { code: 99, kind: AddrNotAvailable, message: \"Cannot assign requested address\" }'\n")),(0,a.kt)("p",null,"Then you need to ",(0,a.kt)("inlineCode",{parentName:"p"},"--announce-host <public ip>")," and `",(0,a.kt)("inlineCode",{parentName:"p"},"--host <local ip>")," on startup. This issue arises because of your use of a provider like AWS or Google Cloud, and the fact that your VPS' available bind address is not the same as the public IP address (see ",(0,a.kt)("a",{parentName:"p",href:"docs/0.11.0/run-nym-nodes/mixnodes"},"Virtual IPs and hosting via Google & AWS")," for more information on this issue)."),(0,a.kt)("h4",{id:"rocketlaunch-warnings"},(0,a.kt)("inlineCode",{parentName:"h4"},"rocket::launch")," warnings"),(0,a.kt)("p",null,"These warnings are not an issue, please ignore them. Rocket is a web framework for rust which we are using to provide mixnodes with ",(0,a.kt)("inlineCode",{parentName:"p"},"/verloc")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"/description")," http APIs."),(0,a.kt)("p",null,"Find more information about this in the ",(0,a.kt)("a",{parentName:"p",href:"docs/0.11.0/run-nym-nodes/mixnodes"},"Mixnodes metrics documentation"),"."),(0,a.kt)("p",null,"Rocket runs on port ",(0,a.kt)("inlineCode",{parentName:"p"},"8000")," by default. Although at this stage of the testnet we need Rocket to be reachable via this port, in the future customization of the particular port it uses will be possible."),(0,a.kt)("h4",{id:"failed-to-receive-reply-to-our-echo-packet-within-15s-stopping-the-test"},(0,a.kt)("inlineCode",{parentName:"h4"},"failed to receive reply to our echo packet within 1.5s. Stopping the test")),(0,a.kt)("p",null,"This relates to the VerLoc implementation that appeared in ",(0,a.kt)("inlineCode",{parentName:"p"},"0.10.1"),", which has a particularly high log sensitivity. This warning means that the echo packet sent to the mixnode was received, but not sent back. ",(0,a.kt)("em",{parentName:"p"},"This will not affect the rate of rewards or performance metrics of your mixnode in the testnet at this point.")),(0,a.kt)("h4",{id:"connection-to-ip1789-seems-to-be-dead"},(0,a.kt)("inlineCode",{parentName:"h4"},"Connection to <IP>:1789 seems to be dead")),(0,a.kt)("p",null,"This warning is normal at the moment, and is ",(0,a.kt)("em",{parentName:"p"},"nothing to do with your mixnode!")," It is simply a warning that your node is unable to connect to other peoples' mixnodes for some reason, most likely because they are offline or poorly configured."),(0,a.kt)("h3",{id:"can-i-use-a-port-other-than-1789-"},"Can I use a port other than 1789 ?"),(0,a.kt)("p",null,"Yes! Here is what you will need to do:"),(0,a.kt)("p",null,"Assuming you would like to use port ",(0,a.kt)("inlineCode",{parentName:"p"},"1337")," for your mixnode, you need to open the new port (and close the old one):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo ufw allow 1337\nsudo ufw deny 1789\n")),(0,a.kt)("p",null,"And then edit the mixnode's config."),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"If you want to change the port for an already running node, you need to stop the process before editing your config file."))),(0,a.kt)("p",null,"Assuming your node name is ",(0,a.kt)("inlineCode",{parentName:"p"},"nym"),", the config file is located at ",(0,a.kt)("inlineCode",{parentName:"p"},"~/.nym/mixnodes/nym/config/config.toml"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"nano ~/.nym/mixnodes/nym/config/config.toml\n")),(0,a.kt)("p",null,"You will need to edit two parts of the file. ",(0,a.kt)("inlineCode",{parentName:"p"},"announce_address")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"listening_address")," in the config.toml file. Simply replace ",(0,a.kt)("inlineCode",{parentName:"p"},":1789")," (the default port) with ",(0,a.kt)("inlineCode",{parentName:"p"},":1337")," (your new port) after your IP address."),(0,a.kt)("p",null,"Finally, restart your node. You should see if the mixnode is using the port you have changed in the config.toml file right after you run the node."),(0,a.kt)("h3",{id:"where-can-i-find-my-private-and-public-keys-and-mixnode-config"},"Where can I find my private and public keys and mixnode config?"),(0,a.kt)("p",null,"All config and keys files are stored in a directory named after your ",(0,a.kt)("inlineCode",{parentName:"p"},"id")," which you chose during the ",(0,a.kt)("inlineCode",{parentName:"p"},"init")," process, and can be found at the following PATH: ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME/.nym/mixnodes/")," where ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME")," is a home directory of the user (your current user in this case) that launched the mixnode."),(0,a.kt)("p",null,"Depending on how you installed Nym, the files will be stored here:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Autoinstaller - ",(0,a.kt)("inlineCode",{parentName:"li"},"/home/nym/.nym/mixnodes/<YOURNODEID>")),(0,a.kt)("li",{parentName:"ol"},"Built from source as your user or root - ",(0,a.kt)("inlineCode",{parentName:"li"},"~/.nym/mixnodes/<YOURNODEID>"))),(0,a.kt)("p",null,"The directory structure is as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"bob@nym:~$ tree /home/nym/.nym/mixnodes/\n/home/nym/.nym/mixnodes/\n|-- nym010\n|   |-- config\n|   |   `-- config.toml\n|   `-- data\n|       |-- private_identity.pem\n|       |-- private_sphinx.pem\n|       |-- public_identity.pem\n|       `-- public_sphinx.pem\n\n\n")),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"If you ",(0,a.kt)("inlineCode",{parentName:"p"},"cat")," the ",(0,a.kt)("inlineCode",{parentName:"p"},"public_sphinx.pem key"),", the output will be different from the public key you will see on Nym ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-explorer.nymtech.net/"},"dashboard"),". The reason for this is that ",(0,a.kt)("inlineCode",{parentName:"p"},".pem")," files are encoded in ",(0,a.kt)("strong",{parentName:"p"},"base64"),", however on the web they are in ",(0,a.kt)("strong",{parentName:"p"},"base58"),". Don't be confused if your keys look different. They are the same keys, just with different encoding :)."))),(0,a.kt)("h3",{id:"what-is-verloc-and-do-i-have-to-configure-my-mixnode-to-implement-it"},"What is ",(0,a.kt)("inlineCode",{parentName:"h3"},"verloc")," and do I have to configure my mixnode to implement it?"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"verloc")," is short for ",(0,a.kt)("em",{parentName:"p"},"verifiable location"),". Mixnodes and gateways now measure speed-of-light distances to each other, in an attempt to verify how far apart they are. In later releases, this will allow us to algorithmically verify node locations in a non-fakeable and trustworthy manner."),(0,a.kt)("p",null,"You don't have to do any additional configuration for your node to implement this, it is a passive process that runs in the background of the mixnet from version ",(0,a.kt)("inlineCode",{parentName:"p"},"0.10.1")," onwards."),(0,a.kt)("h3",{id:"where-can-i-get-more-help"},"Where can I get more help?"),(0,a.kt)("p",null,"The fastest way to reach one of us or get a help from the community, visit our ",(0,a.kt)("a",{parentName:"p",href:"https://t.me/nymchan_help_chat"},"Telegram help chat"),"."),(0,a.kt)("p",null,"For more tech heavy questions join our Keybase channel. Get Keybase ",(0,a.kt)("a",{parentName:"p",href:"https://keybase.io/"},"here"),", then click Teams -> Join a team. Type nymtech.friends into the team name and hit continue. For general chat, hang out in the #general channel. Our development takes places in the #dev channel."))}u.isMDXComponent=!0}}]);
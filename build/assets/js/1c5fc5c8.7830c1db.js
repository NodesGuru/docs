"use strict";(self.webpackChunknym_docs=self.webpackChunknym_docs||[]).push([[6062],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=i,y=u["".concat(l,".").concat(d)]||u[d]||m[d]||r;return n?a.createElement(y,o(o({ref:t},c),{},{components:n})):a.createElement(y,o({ref:t},c))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8987:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return u}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],s={sidebar_label:"Webassembly client",hide_title:!1,description:"How to integrate the Nym webassembly client into your own applications to enable strong privacy for your users",title:"Webassembly client"},l=void 0,p={unversionedId:"build-apps/wasm-client",id:"build-apps/wasm-client",isDocsHomePage:!1,title:"Webassembly client",description:"How to integrate the Nym webassembly client into your own applications to enable strong privacy for your users",source:"@site/docs/build-apps/wasm-client.md",sourceDirName:"build-apps",slug:"/build-apps/wasm-client",permalink:"/docs/current/build-apps/wasm-client",version:"current",lastUpdatedAt:1629392756,formattedLastUpdatedAt:"8/19/2021",frontMatter:{sidebar_label:"Webassembly client",hide_title:!1,description:"How to integrate the Nym webassembly client into your own applications to enable strong privacy for your users",title:"Webassembly client"},sidebar:"sidebar",previous:{title:"Websocket client",permalink:"/docs/current/build-apps/websocket-client"},next:{title:"Demos",permalink:"/docs/current/build-apps/demos"}},c=[{value:"Building apps with nym-client-wasm",id:"building-apps-with-nym-client-wasm",children:[]}],m={toc:c};function u(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Nym webassembly client allows any webassembly-capable runtime to build and send Sphinx packets to the Nym network."),(0,r.kt)("p",null,"You can install ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@nymproject/nym-client-wasm"},"@nymproject/nym-client-wasm")," via ",(0,r.kt)("inlineCode",{parentName:"p"},"npm")," from its package page, or with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm i @nymproject/nym-client-wasm\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"nym-client-wasm")," package allows easy creation of Sphinx packets from within mobile apps and browser-based client-side apps (including Electron or similar). Browser extensions should also work."),(0,r.kt)("p",null,"The webassembly client lets you deliver web apps that build and send Sphinx packets solely in a web browser window. However, note that all the normal constraints of ",(0,r.kt)("a",{parentName:"p",href:"https://pomcor.com/2017/06/02/keys-in-browser/"},"browser-based key storage")," and same-origin rules (which are there for good reason) make it difficult to structure pure webapps apps securely. We are still assessing what can be done here."),(0,r.kt)("h3",{id:"building-apps-with-nym-client-wasm"},"Building apps with nym-client-wasm"),(0,r.kt)("p",null,"There are two example applications located in the directory ",(0,r.kt)("inlineCode",{parentName:"p"},"clients/webassembly")," in the main Nym platform codebase. The ",(0,r.kt)("inlineCode",{parentName:"p"},"js-example")," is a simple, bare-bones JavaScript app. The ",(0,r.kt)("inlineCode",{parentName:"p"},"react-example")," is a nicer-looking chat app done in React and Typescript."),(0,r.kt)("h4",{id:"initializing-a-new-nym-identity"},"Initializing a new Nym identity"),(0,r.kt)("p",null,"The main methods you'll use from the NPM package are:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let identity = new Identity();\n")),(0,r.kt)("p",null,"This generates a new Nym identity, consisting of a public/private keypair and a Nym gateway address."),(0,r.kt)("h4",{id:"constructing-a-nym-client"},"Constructing a Nym client"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let client = new Client(directoryUrl, identity, authToken);\n")),(0,r.kt)("p",null,"This returns a nym Client which connects to a Nym gateway via websocket. All communication with the Nym network happens through this client."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"directoryUrl")," of the Nym testnet is ",(0,r.kt)("inlineCode",{parentName:"p"},"http://testnet-validator1.nymtech.net:8081"),". Use that if you want to connect to the running testnet."),(0,r.kt)("h4",{id:"running-the-nym-client"},"Running the Nym client"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"client.start();\n")),(0,r.kt)("p",null,"This will cause the client to retrieve a network topology from the defined ",(0,r.kt)("inlineCode",{parentName:"p"},"directoryUrl"),", and connect to its gateway via websocket. Cover traffic is not yet sent, but message sends should work after client start."),(0,r.kt)("h4",{id:"sending-messages"},"Sending messages"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"client.sendMessage(message, recipient) {\n")),(0,r.kt)("p",null,"Sends a message up the websocket to this client's Nym gateway."),(0,r.kt)("p",null,"NOTE: the webassembly client currently does not implement chunking. Messages over ~1KB will cause a panic. This will be fixed in a future version."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"message")," must be a string at the moment. Binary ",(0,r.kt)("inlineCode",{parentName:"p"},"Blob")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"ArrayBuffer"),"\nwill be supported soon."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"recipient")," is a Nym address as a string."),(0,r.kt)("h4",{id:"getting-the-clients-address"},"Getting the client's address"),(0,r.kt)("p",null,"Given a client, to get its address, you can call:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"client.formatAsRecipient();\n")),(0,r.kt)("h4",{id:"surbs"},"SURBs"),(0,r.kt)("p",null,"Anonymous replies using surbs don't yet work in the webassembly client. They should be available in the next release."),(0,r.kt)("h4",{id:"json"},"JSON"),(0,r.kt)("p",null,"Sending JSON is fairly simple. If you're playing with the wasm example app, just stick it into the message box and send it (or send it programmatically as the ",(0,r.kt)("inlineCode",{parentName:"p"},"message")," content of ",(0,r.kt)("inlineCode",{parentName:"p"},"client.sendMessage(message, recipient)")," in your own application code."),(0,r.kt)("h4",{id:"think-about-what-youre-sending"},"Think about what you're sending!"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Think about what information your app sends. That goes for whatever you put into your Sphinx packet messages as well as what your app's environment may leak."))),(0,r.kt)("p",null,"Whenever you write client peaps using HTML/JavaScript, we recommend that you do not load external resources from CDNs. Webapp developers do this all the time, to save load time for common resources, or just for convenience. But when you're writing privacy apps it's better not to make these kinds of requests. Pack everything locally."),(0,r.kt)("p",null,"If you use only local resources within your Electron app or your browser extensions, explicitly encoding request data in a Sphinx packet does protect you from the normal leakage that gets sent in a browser HTTP request. ",(0,r.kt)("a",{parentName:"p",href:"https://panopticlick.eff.org/"},"There's a lot of stuff that leaks when you make an HTTP request from a browser window"),". Luckily, all that metadata and request leakage doesn't happen in Nym, because you're choosing very explicitly what to encode into Sphinx packets, instead of sending a whole browser environment by default."))}u.isMDXComponent=!0}}]);
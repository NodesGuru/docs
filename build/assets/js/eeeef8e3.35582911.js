"use strict";(self.webpackChunknym_docs=self.webpackChunknym_docs||[]).push([[3973],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),d=o,y=m["".concat(s,".").concat(d)]||m[d]||p[d]||a;return n?r.createElement(y,i(i({ref:t},c),{},{components:n})):r.createElement(y,i({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8157:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return m}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],l={sidebar_label:"Requesters",description:"Run a requester proxy for the benefit of the community.",hide_title:!1,title:"Requester"},s=void 0,u={unversionedId:"run-nym-nodes/requester",id:"version-0.11.0/run-nym-nodes/requester",isDocsHomePage:!1,title:"Requester",description:"Run a requester proxy for the benefit of the community.",source:"@site/versioned_docs/version-0.11.0/run-nym-nodes/requester.md",sourceDirName:"run-nym-nodes",slug:"/run-nym-nodes/requester",permalink:"/docs/0.11.0/run-nym-nodes/requester",version:"0.11.0",lastUpdatedAt:1629392815,formattedLastUpdatedAt:"8/19/2021",frontMatter:{sidebar_label:"Requesters",description:"Run a requester proxy for the benefit of the community.",hide_title:!1,title:"Requester"},sidebar:"version-0.11.0/sidebar",previous:{title:"Validators",permalink:"/docs/0.11.0/run-nym-nodes/validators"},next:{title:"Gateways",permalink:"/docs/0.11.0/run-nym-nodes/gateways"}},c=[{value:"Running your nym client",id:"running-your-nym-client",children:[]},{value:"Running your network requester",id:"running-your-network-requester",children:[]},{value:"Configure your firewall",id:"configure-your-firewall",children:[{value:"Using your network requester",id:"using-your-network-requester",children:[]},{value:"Adding URLs for other clients",id:"adding-urls-for-other-clients",children:[]},{value:"Running an open proxy",id:"running-an-open-proxy",children:[]},{value:"Requester port reference",id:"requester-port-reference",children:[]}]}],p={toc:c};function m(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The Nym network requester was built in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/0.11.0/run-nym-nodes/build-nym/"},"building nym")," section. If you haven't yet built Nym and want to run the code on this page, go there first."))),(0,a.kt)("p",null,"If you have access to a server, you can run the nym-network-requester, which allows Nym users to make outbound network requests from your server."),(0,a.kt)("p",null,"The nym-network-requester is NOT an open proxy. It ships with a file called ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list.sample"),", which contains URLs used by the Blockstream Green and Electrum cryptographic wallets."),(0,a.kt)("h3",{id:"running-your-nym-client"},"Running your nym client"),(0,a.kt)("p",null,"Before initializing your nym-network-requester, you must initialize an instance of the nym-client binary for it to listen to."),(0,a.kt)("p",null,"First of all, choose which gateway to connect your client to. Active gateways can be found in the 'Gateways' ",(0,a.kt)("a",{parentName:"p",href:"https://testnet-milhon-explorer.nymtech.net/nym/gateways"},"section of the explorer"),"."),(0,a.kt)("p",null,"Then initialize your nym client with the ID key of your gateway of choice: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"nym@localhost:~$ ./nym-client init --id requester-client --gateway <GATEWAY_ID>\n")),(0,a.kt)("p",null,"Which should return: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"\n      _ __  _   _ _ __ ___\n     | '_ \\| | | | '_ \\ _ \\\n     | | | | |_| | | | | | |\n     |_| |_|\\__, |_| |_| |_|\n            |___/\n\n             (client - version 0.11.0)\n\n    \nInitialising client...\nSaved all generated keys\nSaved configuration file to \"/home/nym/.nym/clients/requester-client/config/config.toml\"\nUsing gateway: 8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i\nClient configuration completed.\n\n\nThe address of this client is: BUVD1uAXEWSfMDdewwfxUAd6gSsEfHHPvnsV8LTfe9ZG.DaY9kqXREEkvpJ1Nv3nrfxF6HDamsJmtZQDFuyTAXwJZ@8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i\n")),(0,a.kt)("p",null,"Now create a service file at ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/systemd/system/nym-client.service"),": "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[Unit]\nDescription=Nym Client (0.11.0)\nStartLimitInterval=350\nStartLimitBurst=10\n\n[Service]\nUser=nym # replace this with whatever user you wish \nLimitNOFILE=65536\nExecStart=/home/nym/nym-client run --id requester-client # remember to check the path to your nym-client binary and the id of your client \nKillSignal=SIGINT\nRestart=on-failure\nRestartSec=30\n\n[Install]\nWantedBy=multi-user.target\n")),(0,a.kt)("p",null,"Then enable and start your client with the following commands: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl enable nym-client.service\nsystemctl start nym-client.service\n\n# you can always check your client has succesfully started with: \nsystemctl status nym-client.service\n")),(0,a.kt)("p",null,"With ",(0,a.kt)("inlineCode",{parentName:"p"},"systemctl status nym-client.service")," you should be able to see the address of the client at startup. Alternatively you can use ",(0,a.kt)("inlineCode",{parentName:"p"},"journalctl -t nym-client -o cat -f")," to get the output of the client in your console as it comes in. "),(0,a.kt)("p",null,"Make a note of the client's address:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"}," 2021-07-10T14:45:50.131 INFO  nym_client::client              > The address of this client is: BLJ6SrgbaYjb7Px32G7zSZnocuim3HT9n3ocKcwQHETd.4WAAh7xRxWVeiohcw44G8wQ5bGHMEvq8j9LctDkGKUC7@8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i\n")),(0,a.kt)("h3",{id:"running-your-network-requester"},"Running your network requester"),(0,a.kt)("p",null,"Now that we have a running client for the requester to listen to, we can start it with the following command : "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"nym@localhost:~$ ./nym-network-requester \n\nStarting socks5 service provider:\n 2021-08-11T13:28:02.767Z INFO  nym_network_requester::core > * connected to local websocket server at ws://localhost:1977\n\nAll systems go. Press CTRL-C to stop the server.\n")),(0,a.kt)("p",null,"As you can see, it has connected to the nym client that we started before. "),(0,a.kt)("p",null,"Now stop that process with ",(0,a.kt)("inlineCode",{parentName:"p"},"CTRL-C"),", and create a service file for the requester as we did with our client instance previously at ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/systemd/system/nym-network-requester.service"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[Unit]\nDescription=Nym Client (0.11.0)\nStartLimitInterval=350\nStartLimitBurst=10\n\n[Service]\nUser=nym # replace this with whatever user you wish \nLimitNOFILE=65536\nExecStart=/home/nym/nym-network-requester # remember to check the path to your nym-network-requester binary \nKillSignal=SIGINT\nRestart=on-failure\nRestartSec=30\n\n[Install]\nWantedBy=multi-user.target\n")),(0,a.kt)("p",null,"Now enable and start your requester: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl enable nym-network-requester.service\nsystemctl start nym-network-requester.service\n\n# you can always check your requester has succesfully started with: \nsystemctl status nym-network-requester.service\n")),(0,a.kt)("h2",{id:"configure-your-firewall"},"Configure your firewall"),(0,a.kt)("p",null,"Although your requester is now ready to receive traffic, your server may not be - the following commands will allow you to set up a properly configured firewall using ",(0,a.kt)("inlineCode",{parentName:"p"},"ufw"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# check if you have ufw installed\nufw version\n# if it is not installed, install with\nsudo apt install ufw -y\n# enable ufw\nsudo ufw enable\n# check the status of the firewall\nsudo ufw status\n")),(0,a.kt)("p",null,"Finally open your requester's p2p port, as well as ports for ssh and incoming traffic connections:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo ufw allow 1789,22,9000/tcp\n# check the status of the firewall\nsudo ufw status\n")),(0,a.kt)("p",null,"For more information about your requester's port configuration, check the ",(0,a.kt)("a",{parentName:"p",href:"#requester-port-reference"},"requester port reference table")," below."),(0,a.kt)("h3",{id:"using-your-network-requester"},"Using your network requester"),(0,a.kt)("p",null,"You can safely share the address of your running nym-client with however you want - if you would like to run a nym-network-requester for the whole Nym network, give it to us and we can even put it in the Nym documentation."),(0,a.kt)("p",null,"Is this safe to do? If it was an open proxy, this would be unsafe, because any Nym user could make network requests to any system on the internet."),(0,a.kt)("p",null,"To make things a bit less stressful for administrators, nym-network-requester drops all incoming requests by default. In order for it to make requests, you need to add specific domains to the ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list")," file at ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME/.nym/service-providers/nym-network-requester/allowed.list"),"."),(0,a.kt)("p",null,"If you want, you can just use the domains in the default ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list"),", by running this command from the top-level ",(0,a.kt)("inlineCode",{parentName:"p"},"nym")," code directory:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"cp service-providers/nym-network-requester/allowed.list.sample ~/.nym/service-providers/nym-network-requester/allowed.list")),(0,a.kt)("p",null,"Those URLs will let through requests for the Blockstream Green and Electrum cryptocurrency wallets, as well as the KeyBase chat client."),(0,a.kt)("p",null,"  :::caution\nIf you change your ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list"),", make sure you restart nym-network-requester.service to pick up the new allowed request list\n:::"),(0,a.kt)("h3",{id:"adding-urls-for-other-clients"},"Adding URLs for other clients"),(0,a.kt)("p",null,"It would suck if Nym was restricted to only three clients. How can we add support for a new application? It's fairly easy to do."),(0,a.kt)("p",null,"Have a look in your nym-network-requester config directory:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ls $HOME/.nym/service-providers/network-requester/\n\n# returns: allowed.list  unknown.list\n")),(0,a.kt)("p",null,"We already know that ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list")," is what lets requests go through. All unknown requests are logged to ",(0,a.kt)("inlineCode",{parentName:"p"},"unknown.list"),". If you want to try using a new client type, just start the new application, point it at your local SOCKS5 proxy (configured to use your remote ",(0,a.kt)("inlineCode",{parentName:"p"},"nym-network-requester"),"), and keep copying URLs from ",(0,a.kt)("inlineCode",{parentName:"p"},"unknown.list")," into ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list")," (it may take multiple tries until you get all of them, depending on the complexity of the application)."),(0,a.kt)("p",null,"If you add support for a new application, we'd love to hear about it: let us know or submit a commented pull request on ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed.list.sample"),". "),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"If you are adding custom domains, please note that whilst they may appear in the logs of your network-requester as something like ",(0,a.kt)("inlineCode",{parentName:"p"},"api-0.core.keybaseapi.com:443"),", you ",(0,a.kt)("strong",{parentName:"p"},"only need")," to include the main domain name, in this instance ",(0,a.kt)("inlineCode",{parentName:"p"},"keybaseapi.com")))),(0,a.kt)("h3",{id:"running-an-open-proxy"},"Running an open proxy"),(0,a.kt)("p",null,"If you really, really want to run an open proxy, perhaps for testing purposes for your own use or among a small group of trusted friends, it is possible to do so. You can disable network checks by passing the flag ",(0,a.kt)("inlineCode",{parentName:"p"},"--open-proxy")," flag when you run it. If you run in this configuration, you do so at your own risk."),(0,a.kt)("h3",{id:"requester-port-reference"},"Requester port reference"),(0,a.kt)("p",null,"All requester-specific port configuration can be found in ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME/.nym/clients/<YOUR_ID>/config/config.toml")," & ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME/.nym/service-providers/<YOUR_ID>/config/config.toml"),". If you do edit any port configs, remember to restart your client and requester processes."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Default port"),(0,a.kt)("th",{parentName:"tr",align:null},"Use"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"1789"),(0,a.kt)("td",{parentName:"tr",align:null},"Listen for Mixnet traffic")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"9000"),(0,a.kt)("td",{parentName:"tr",align:null},"Listen for Client traffic")))))}m.isMDXComponent=!0}}]);